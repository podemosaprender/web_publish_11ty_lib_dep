Element.prototype.closest||(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest=function(t){var e=this;if(document.documentElement.contains(this))do{if(e.matches(t))return e}while(null!==(e=e.parentElement));return null}),function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}"function"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,window.CustomEvent=t)}(),function(t,e){"function"==typeof define&&define.amd?define([],function(){return e(t)}):"object"==typeof exports?module.exports=e(t):t.Gumshoe=e(t)}("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,function(u){function f(t,e,n){n.settings.events&&(t=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n}),e.dispatchEvent(t))}function n(t){var e=0;if(t.offsetParent)for(;t;)e+=t.offsetTop,t=t.offsetParent;return 0<=e?e:0}function d(t){t.sort(function(t,e){return n(t.content)<n(e.content)?-1:1})}function v(t,e){var n;t&&(n=t.nav.closest("li"))&&(n.classList.remove(e.navClass),t.content.classList.remove(e.contentClass),o(n,e),f("gumshoeDeactivate",n,{link:t.nav,content:t.content,settings:e}))}function m(t,e){e.nested&&(t=t.parentNode.closest("li"))&&(t.classList.add(e.nestedClass),m(t,e))}var p={navClass:"active",contentClass:"active",nested:!1,nestedClass:"active",offset:0,reflow:!1,events:!0},o=function(t,e){e.nested&&(t=t.parentNode.closest("li"))&&(t.classList.remove(e.nestedClass),o(t,e))};return function(t,e){function n(t){r&&u.cancelAnimationFrame(r),r=u.requestAnimationFrame(l.detect)}function o(t){r&&u.cancelAnimationFrame(r),r=u.requestAnimationFrame(function(){d(),l.detect()})}var s,c,i,r,a,l={setup:function(){s=document.querySelectorAll(t),c=[],Array.prototype.forEach.call(s,function(t){var e=document.getElementById(decodeURIComponent(t.hash.substr(1)));e&&c.push({nav:t,content:e})}),d(c)}};l.detect=function(){var t,e,n,o=function(t,e){for(var n=t.length-1;0<=n;n--)if(function(t,e){t=t.getBoundingClientRect(),e="function"==typeof(e=e).offset?parseFloat(e.offset()):parseFloat(e.offset);return parseFloat(t.top)<=e&&parseFloat(t.bottom)>e}(t[n].content,e))return t[n]}(c,a);o?i&&o.content===i.content||(v(i,a),e=a,(t=o)&&(n=t.nav.closest("li"))&&(n.classList.add(e.navClass),t.content.classList.add(e.contentClass),m(n,e),f("gumshoeActivate",n,{link:t.nav,content:t.content,settings:e})),i=o):i&&(v(i,a),i=null)};return l.destroy=function(){i&&v(i),u.removeEventListener("scroll",n,!1),a.reflow&&u.removeEventListener("resize",o,!1),a=r=i=s=c=null},l.init=function(t){a=function(){var n={};return Array.prototype.forEach.call(arguments,function(t){for(var e in t){if(!t.hasOwnProperty(e))return;n[e]=t[e]}}),n}(p,t||{}),l.setup(),l.detect(),u.addEventListener("scroll",n,!1),a.reflow&&u.addEventListener("resize",o,!1)},l.init(e),l}});